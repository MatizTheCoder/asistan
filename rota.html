
<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rota Hava Durumu</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = { darkMode: 'class' };
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
</head>
<body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 font-sans">

<main class="max-w-xl mx-auto p-4">
  <h1 class="text-2xl font-bold mb-4">Rota Hava Durumu (Her 50km)</h1>
  <div id="route-weather"></div>
</main>

<script>
const routePoints = [
  { lat: 39.9208, lon: 32.8541 },
  { lat: 39.7706, lon: 32.2816 },
  { lat: 39.6205, lon: 31.7090 },
  { lat: 39.4703, lon: 31.1365 },
  { lat: 39.3202, lon: 30.5639 },
  { lat: 39.1700, lon: 29.9914 },
  { lat: 39.0198, lon: 29.4189 },
  { lat: 38.8697, lon: 28.8463 },
  { lat: 38.7195, lon: 28.2738 },
  { lat: 38.5694, lon: 27.7012 },
  { lat: 38.4192, lon: 27.1287 }
];

async function getLocationName(lat, lon) {
  const url = `https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lon}&format=json&addressdetails=1`;
  try {
    const response = await fetch(url, {
      headers: {
        'User-Agent': 'YourAppName/1.0 (your.email@example.com)'
      }
    });
    const data = await response.json();
    const address = data.address;
    return address.city || address.town || address.village || address.county || "Bilinmeyen Konum";
  } catch (error) {
    console.error("Ters geocoding hatası:", error);
    return "Bilinmeyen Konum";
  }
}

async function getWeather(lat, lon) {
  const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`;
  try {
    const response = await fetch(url);
    const data = await response.json();
    const weather = data.current_weather;
    return {
      temperature: weather.temperature,
      windspeed: weather.windspeed,
      weathercode: weather.weathercode
    };
  } catch (error) {
    console.error("Hava durumu verisi alınamadı:", error);
    return null;
  }
}

function weatherCodeToText(code) {
  const map = {
    0: "Güneşli", 1: "Az Bulutlu", 2: "Parçalı Bulutlu", 3: "Kapalı",
    45: "Sisli", 51: "Çiseleme", 61: "Yağmurlu", 71: "Kar", 80: "Sağanak"
  };
  return map[code] || "Bilinmiyor";
}

async function displayRouteWeather() {
  const container = document.getElementById("route-weather");
  for (const point of routePoints) {
    const locationName = await getLocationName(point.lat, point.lon);
    const weather = await getWeather(point.lat, point.lon);
    if (weather) {
      const weatherText = weatherCodeToText(weather.weathercode);
      const weatherHTML = `
        <div class="bg-blue-100 dark:bg-blue-900 rounded-xl p-4 shadow mb-4">
          <h3 class="text-lg font-bold mb-2">${locationName}</h3>
          <p>Sıcaklık: ${weather.temperature}°C</p>
          <p>Rüzgar Hızı: ${weather.windspeed} km/h</p>
          <p>Hava Durumu: ${weatherText}</p>
        </div>
      `;
      container.innerHTML += weatherHTML;
    }
  }
}

window.addEventListener("load", () => {
  displayRouteWeather();
});
</script>

</body>
</html>
