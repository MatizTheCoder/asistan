<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Detaylı Hava Durumu</title>

  <!-- Tailwind dark mode -->
  <script>
    tailwind.config = { darkMode: 'class' }
  </script>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Dark mode başlangıç kontrolü -->
  <script>
    (function () {
      const theme = localStorage.getItem("theme");
      if (theme === "dark") {
        document.documentElement.classList.add("dark");
      }
    })();
  </script>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
</head>
<body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 font-sans">
  <main class="max-w-md mx-auto p-4 space-y-6">

    <!-- Geri Butonu -->
    <a href="index.html" class="text-blue-500 hover:underline text-sm flex items-center">
      <i class="fas fa-arrow-left mr-2"></i> Geri Dön
    </a>

    <h1 class="text-2xl font-bold text-center mb-4">Detaylı Hava Durumu</h1>

    <div id="details" class="bg-gray-100 dark:bg-gray-800 rounded-xl p-4 shadow text-sm space-y-2">
      <p>Yükleniyor...</p>
    </div>
  </main>

  <script>
    async function getWeatherDetails(lat, lon) {
      const apiKey = "YOUR_API_KEY"; // <-- Kendi OpenWeather API anahtarını buraya yaz
      const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&lang=tr&appid=${apiKey}`;

      try {
        const res = await fetch(url);
        const data = await res.json();

        const sunrise = new Date(data.sys.sunrise * 1000).toLocaleTimeString('tr-TR');
        const sunset = new Date(data.sys.sunset * 1000).toLocaleTimeString('tr-TR');

        const html = `
          <div><strong>Konum:</strong> ${data.name || "Bilinmiyor"}</div>
          <div><strong>Açıklama:</strong> ${data.weather[0].description}</div>
          <div><strong>Sıcaklık:</strong> ${data.main.temp}°C</div>
          <div><strong>Hissedilen:</strong> ${data.main.feels_like}°C</div>
          <div><strong>Nem:</strong> ${data.main.humidity}%</div>
          <div><strong>Basınç:</strong> ${data.main.pressure} hPa</div>
          <div><strong>Rüzgar:</strong> ${data.wind.speed} m/sn, yön: ${data.wind.deg}°</div>
          <div><strong>Görüş Mesafesi:</strong> ${data.visibility / 1000} km</div>
          <div><strong>Bulutluluk:</strong> ${data.clouds.all}%</div>
          <div><strong>Gün Doğumu:</strong> ${sunrise}</div>
          <div><strong>Gün Batımı:</strong> ${sunset}</div>
        `;

        document.getElementById("details").innerHTML = html;

      } catch (error) {
        document.getElementById("details").innerHTML = "<p>Veriler alınamadı.</p>";
        console.error("Detay verileri alınamadı:", error);
      }
    }

    function getQueryParams() {
      const params = new URLSearchParams(window.location.search);
      return {
        lat: params.get("lat"),
        lon: params.get("lon")
      };
    }

    const { lat, lon } = getQueryParams();
    if (lat && lon) {
      getWeatherDetails(lat, lon);
    } else {
      document.getElementById("details").innerHTML = "<p>Konum bilgisi bulunamadı.</p>";
    }
  </script>
</body>
</html>
